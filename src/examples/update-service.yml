description: |
  Use the AWS CLI and this orb to update an ECS service.
  (Supports both EC2 and Fargate launch types)
usage:
  version: 2.1
  orbs:
    aws-cli: circleci/aws-cli@0.1.4
    aws-ecs: circleci/aws-ecs@0.0.10
  jobs:
    update-tag:
      docker:
        - image: 'circleci/python:3.7.1'
      steps:
        - aws-cli/install
        - aws-cli/configure:
            aws-access-key-id: $AWS_ACCESS_KEY_ID
            aws-region: $AWS_REGION
        - aws-ecs/update-service:
            family: '${MY_APP_PREFIX}-service'
            cluster-name: '${MY_APP_PREFIX}-cluster'
            container-image-name-updates: 'container=${MY_APP_PREFIX}-service,tag=stable'
  workflows:
    deploy:
      jobs:
        - update-tag
