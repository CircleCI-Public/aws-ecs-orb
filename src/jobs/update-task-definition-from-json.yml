docker:
  - image: << parameters.docker-image-for-job >>
parameters:
  docker-image-for-job:
    description: The docker image to be used for running this job on CircleCI.
    type: string
    default: 'circleci/python:3.7.1'
  aws-access-key-id:
    description: |
      AWS access key id for IAM role. Defaulted to $AWS_ACCESS_KEY_ID
    type: string
    default: $AWS_ACCESS_KEY_ID
  aws-secret-access-key:
    description: |
      AWS secret key for IAM role. Defaulted to $AWS_SECRET_ACCESS_KEY
    type: string
    default: $AWS_SECRET_ACCESS_KEY
  aws-region:
    description: AWS region to operate in. Defaulted to $AWS_REGION
    type: string
    default: $AWS_REGION
  task-definition-json:
    description: |
      Location of your .json task definition file (relative or absolute).
    type: string
steps:
  - aws-cli/install
  - aws-cli/configure:
      aws-access-key-id: << parameters.aws-access-key-id >>
      aws-secret-access-key: << parameters.aws-secret-access-key >>
      aws-region: << parameters.aws-region >>
  - update-task-definition-from-json:
      task-definition-json: << parameters.task-definition-json >>